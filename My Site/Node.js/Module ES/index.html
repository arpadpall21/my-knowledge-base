<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title> Module: ECMAScript </title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
      integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../../Assets/stylesPages.css">
    <script src="../../Assets/scriptPages.js"></script>
  </head>

  <body>
    <h1> Module: ES (ECMAScript)
      <span class="browserSupport" title="updated : 2025-03-03">
        <span><i class="fab fa-node-js"></i> 14 </span>
      </span>
    </h1>
    <p> Updated: ( 2021-01-12 / 2025-03-03 )</p>
    <nav class="sitenav"> <a href="../../index.html">MySite > </a>
      <a href="../index.html">Node.js > </a> Module: ECMAScript
    </nav>
    <table class="table">
      <caption>
        Loading files as ECMAScript module
      </caption>
      <tr>
        <th style="width:30%;"> File </th>
        <th> Description </th>
      </tr>
      <tr>
        <td> <strong>moduleFile</strong>.mjs </td>
        <td> - Node.js loads the file as ECMAScript module </td>
      </tr>
      <tr>
        <td> <strong>moduleFile</strong>.js </td>
        <td>
          - loads CommonJS module (does not support decomposition on import) <br>
          - if the nearest <mark>package.json</mark> file contains a top-level <mark>"type":"module"</mark> field then
          Node.js loads this file as ECMAScript module <br>
          - if the nearest <mark>package.json</mark> file contains a top-level <mark>"type":"commonjs"</mark> field or
          doesn't contain any <mark>"type"</mark> field then Node.js loads this file as CommonJS module
        </td>
      </tr>
    </table>
    <br>
    <table class="table">
      <caption>
        ECMAScript module statements and properties
        <span class="changeListOrder">[Ordered: <span>Alphabetically</span>]</span>
      </caption>
      <tr>
        <th style="width:30%;"> Statement / Property </th>
        <th> Description </th>
      </tr>
      <tr>
        <td colspan="2"> import </td>
      </tr>
      <tr>
        <td>
          import <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - module imported for its side effect
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          import * as <reqval>var</reqval> from <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - imports all exported properties and default export as <reqval>var</reqval>
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          import <optval>default</optval>, { <strong>prop</strong> <small>[as <i>newName</i>]</small>, <i>...</i> } from <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - imports <reqval>prop</reqval> (properties) (and the default export)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          import(<strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>)
        </td>
        <td>
          - dynamic import (can be called from any code bloc ex: a function body)<br>
          - returns a <strong>promise</strong> which resolves to the required module
          <span class="browserSupport" title="updated : 2021-01-16">
            <span><i class="fab fa-node-js"></i> 14.8.0 </span>
          </span>
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> import.meta.url </td>
        <td> - returns the absolute path of the current location <u>as a file path</u> (ex: <mark>file:///home/dev/main.mjs</mark>) </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2"> export </td>
      </tr>
      <tr>
        <td>
          export <em>var|let|const</em> <strong>name</strong> <small>[= <i>val</i>]</small>, <i>...</i>
        </td>
        <td>
          - expors one or multiple individual names <u>(<mark>var|let|const</mark> required only in front (ex:
            <mark>import var x 21, y = 22, z = 23</mark>))</u>
        </td>
      </tr>
      <tr>
        <td>
          export function <strong>fnName</strong>() {<i>...</i>}
        </td>
        <td>
          - exports an individual function bound to a name
        </td>
      </tr>
      <tr>
        <td>
          export class <strong>className</strong> {<i>...</i>}
        </td>
        <td>
          - exports an individual class bound to a name
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          export { <strong>var</strong> <small>[as <i>newName|</i>default]</small>, <i>...</i> }
        </td>
        <td>
          - overrides the export object with the passed variables (can export default value)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          export default <strong>val:any</strong>
        </td>
        <td>
          - default export
        </td>
      </tr>
      <tr>
        <td>
          export default function* <i>fn</i>(){<i>...</i>}
        </td>
        <td>
          - exports the function (or generator function <mark>*</mark>) as default
        </td>
      </tr>
      <tr>
        <td>
          export default class <i>name</i>{<i>...</i>}
        </td>
        <td>
          - exports the Class as default
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          export { <opt>default</opt>, <strong>var</strong> <small>[as <i>newName|</i>default]</small>, <i>...</i> } from <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - re-exports the specified names (<reqval>var</reqval>) from the source module, can re-export default values
        </td>
      </tr>
      <tr>
        <td>
          export * as <reqval>var</reqval> <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - re-exports all named imports from the source module wrappend in an object <reqval>var</reqval> <u>(default not re-exported)</u>
        </td>
      </tr>
      <tr>
        <td>
          export * from <strong class="openable">specifier:str<div>
              <p> - <mark><strong>relativePath</strong></mark> - relative specifier (ex: <mark>./main.js</mark>) </p>
              <p style="text-indent: 10px;"> - relative path from the current location <u>(file extensions are required)</u> </p>
              <p> - <mark><strong>absolutePath</strong></mark> - absolute specifier (ex: <mark>/home/dev/main.js</mark>) </p>
              <p style="text-indent: 10px;"> - absolute path <u>in ECMAscript modules we can also pass file protocol path <mark>"file:///home/dev/main.js</mark> (browser percent encoded)</u> </p>
              <p> - <mark><strong><small>[node:]</small>moduleName<small>/<i>path</i></small></strong></mark> - bare specifier (ex: <mark>main</mark> / <mark>mymodule/main</mark> / <mark>node:fs</mark>) </p>
              <p style="text-indent: 10px;"> - built-in module or package entry point to the nearest <mark>node_modules</mark> directory <u>(<mark>node:</mark> prefix indicates built-in node module
                  <span id="browserSupport" title="updated : 2021-01-11">
                    <span><i class="fab fa-node-js"></i> 16.0.0 </span>
                  </span>
                  )</u></p>
            </div></strong>
        </td>
        <td>
          - re-exports all named imports from the source module <u>(default not re-exported)</u>
        </td>
      </tr>
    </table>
    <h2 style="color:green;"><u> Notes : </u></h2>
    <details class="example" id="notes">
      <summary> Notes :</summary>
      <!-- <p> - paragraph removes the 'empty' message from the detail TAG -->
    </details>
    <h2 style="color:green;"><u> Useful Links : </u></h2>
    <p><a href="https://nodejs.org/dist/latest-v15.x/docs/api/esm.html" target="_blank">ECMAScript modules
        (nodejs.org)</a></p>
    <h2 style="color:green;"><u> Remember This : </u></h2>
    <h2 style="color:green;"><u> Description and Demonstration : </u></h2>

    <p> - Node.js loads a file as ECMAScript module when : </p>
    <p style="text-indent:35px;"> - a file has <mark>*.mjs</mark> extension </p>
    <p style="text-indent:35px;"> - a file has <mark>*.js</mark> extension and the nearest <mark>package.json</mark> file contains a top-level <mark>"type":"module"</mark> field </p>
    <p> - ECMAScript modules can import (require) both ECMAScript and CommonJS modules </p>
    <p> - the code inside ECMAScript modules <u>runs in strict mode</u></p>
    <details class="example">
      <summary> DEMO </summary>
      <p> - <mark>main.mjs</mark> file (loades as ECMAScript module) </p>
      <pre>
    import * as test1 from './module1.mjs';                                            // can import data from ECMAScript modules   
    import test2 from './module1.cjs';                                                 // also can import data from CommonJS modules   
    
// module runs in strict mode ---------------------------------------------------------
    x = 21;                                                                            // -! Error thrown (undeclared variables are not allowed in strict mode)   
    </pre>
      <hr>
      <!---------------------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> Loading <mark>*.js</mark> files as CommonJS module </u></h4>
      <p> - <mark>main.js</mark> file <u>loaded as ECMAScript module because the nearest <mark>package.json</mark> file
          has a top-level <mark>"type":"module"</mark> field</u> </p>
      <pre>
    import fs from 'fs';                                                               // file loaded as ECMAScript module   
    </pre>
      <p> - nearest <mark>package.json</mark> file </p>
      <pre>
    {
    "name": "module-ecmascript",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts": {
        "test": "echo \"Error: no test specified\" && exit 1"
    },
    "author": "",
    "license": "ISC",
    "type":"module"                                                                    // this makes Node.js load *.js files as ECMAScript module  
    }
    </pre>
    </details>
    <hr>
    <!---------------------------------------------------------------------------------------------------->
    <h2 class="header"> Dynamic import
      <i class="fab fa-js">2020</i>
      <span id="browserSupport" title="updated: 2025-03-01">
        <span><i class="fab fa-chrome"></i> 63 </span>
        <span><i class="fab fa-firefox"></i> 67 </span>
        <span><i class="fab fa-opera"></i> 50 </span>
        <span><i class="fab fa-internet-explorer"></i><i class="fab fa-edge"></i> 79 </span>
        <span><i class="fab fa-safari"></i> 11.1 </span>
        <span><i class="fab fa-node-js"></i> 14 </span>
      </span>
    </h2>
      <pre>
// static -------------------------------------------
    import * as module1 from './module1.mjs';        // synchronous import    
    
    
// dynamic --------------------------------------------
    import('./module2.mjs')                           // resulves to the imported module
        .then(mod => mod)                           // -> imported module
        .catch(err => {err})
    </pre>
    </details>
    <hr>
    <!---------------------------------------------------------------------------------------------------->
    <h3 class="header"> The <mark>import</mark> / <mark>import()</mark> / <mark>await import</mark> / <mark>export</mark> / <mark>import.meta.url</mark> statements and property </h3>
    <details class="example">
      <summary> DEMO </summary>
      <p> <mark>import</mark> </p>
      <pre>
// no data imported -------------------------------------------------------------------
    import './module1.mjs';                                                            // no data imported, './module1.mjs' called for its side effect only  
    
// importing named items --------------------------------------------------------------
    import * as all from './module1.mjs';                                              // all named items (default included) are imported in the 'all' namespace 
    all;                                                                                   // -> {all named items default included ...}
    
    import {egy, ketto} from './module1.mjs';                                          // 'egy' and 'ketto' named items imported (named items are exported under the same name 'egy', 'ketto' in this case)    
    egy;                                                                                   // -> imported value under this name  
    ketto;                                                                                 // -> imported value under this name  
    
    import {egy as un, ketto as deux} from './module1.mjs';                            // rename named items while importing 
    un;                                                                                    // -> imported value under the 'egy' name  
    deux;                                                                                  // -> imported value under the 'ketto' name  
    
// import default value ---------------------------------------------------------------// -! only 1 default import allowed (bellow is for the sake of demo)    
    import def from './module1.mjs';                                                   // imports the default value     // def can be named as we like 
    def;                                                                                   // -> default export value of './module1.mjs'   
    
    import def, {ketto, harom as trois} from './module1.mjs';                          // imports the default value and other named items 
    def;                                                                                   // -> default export value of './module1.mjs'   
    ketto;                                                                                 // -> imported value under the 'ketto' name  
    trois;                                                                                 // -> imported value under the 'harom' name  
    
// dynamic import ---------------------------------------------------------------------
    import('./module2.mjs')                                                            // module loaded once the promise is resolved    
        .then(module  => {module})                                                     // -> imported data will be available here  
        .catch(err => {err})
    
    await import('./module2.mjs')                                                      // top level await is supported from node v14.8.0   
    </pre>
      <p> <mark>export</mark> </p>
      <pre>
// exporting individual features ------------------------------------------------------
    export var x = 21;                                                                 // exports one named item  
    export let x = 21, y = 'some string';                                              // exports multiple features     // -! var|let|const must be declared only once at the beginning    
    
    var a = 'one thing';
    var b = 'some other thing';
    export var a, b;                                                                   // exports a variable binding as named item    
    
    export function myFunc(a, b){return a + b}                                         // exports a function as 'myFunc' named item
    
    export class Cat{constructor(breed, color){this.breed = breed, this.color = color}};  // exports a class as 'Cat' named item  
    
// exporting a list of items ----------------------------------------------------------
    var a = 'one thing';
    var b = 'another thing';
    export {a, b};                                                                     // exporting a list of named items    
    
    export {a as one, b as two};                                                       // renames named items while exporting (importing modules will receive 'one' and 'two' named items)    
    
// default export ---------------------------------------------------------------------// -! only 1 default export allowed (bellow is for the sake of demo)    
    default 1 + 2;                                                                     // exports 3 as default export value  
    
    var a = 'default value';
    export {a as default};                                                             // exports the value of 'a' as default value  
    
    export default function(){return 'default value'}                                  // exports the function as default value 
    
    export default class {constructor(breed, color){this.breed = breed, this.color = color}};       // exports the class as default value   
    
    export default function myFunc(){return 'default value'}                                        // can have a name but I'm not sure what this does (doesn't seems do anything)    
    export default class Cat{constructor(breed, color){this.breed = breed, this.color = color}};    // can have a name but I'm not sure what this does (doesn't seems do anything)    
    
// aggregate export (import then export) ----------------------------------------------// -! the transfered data is not available in the current module    
    export * from './module2.mjs'                                                      // imports all named items from './module2.mjs' then export it   // -! default value is not transfered    
    
    export * as all from './module2.mjs'                                               // imports all named itmes (including default) and exports them in the 'all' namespace   // -! default not exported as default value    
    all;                                                                                   // -! Error thrown transfered items are not available here    
    
    export {egy, ketto} from './module2.mjs';                                          // imports the specified named items then exports them 
    export {ketto as deux} from './module2.mjs';                                       // renames the item whild transfering  
    egy;                                                                                   // -! Error thrown transfered items are not available here    
    deux;                                                                                  // -! Error thrown transfered items are not available here    
    
    export { default } from './module2.mjs';                                           // imports the default value then exports it as default value 
    </pre>
      <p> - other <mark>import.meta.url</mark> property </p>
      <pre>
    import.meta.url;                                                                   // -> 'file:///home/pall/Node.js/Module%20ECMAScript/main.mjs'       // absolute path of the module location (as file protocol (percent encoded))    
    </pre>
    </details>
    <!---------------------------------------------------------------------------------------------------->
    <hr>
    <h2 style="color:darkblue;"><u> Top level <mark>await</mark>
        <span class="browserSupport" title="updated : 2021-09-07">
          <span><i class="fab fa-chrome"></i> 89 </span>
          <span><i class="fab fa-firefox"></i> 89 </span>
          <span><i class="fab fa-opera"></i> 75 </span>
          <span><i class="fab fa-internet-explorer"></i><i class="fab fa-edge"></i> 89 </span>
          <span><i class="fab fa-safari"></i> 15 </span>
          <span><i class="fab fa-node-js"></i> 14.8 </span>
        </span>
      </u></h2>
    <p> - top level await supported only by ES module (but not by CommonJs module) </p>
    <details class="example">
      <summary> DEMO </summary>
      <pre>
  // &lt;script src="./topAwait.js" type="module"&gt;&lt;/script&gt; (file) -----------------------
  
  const resPromise = new Promise((res, rej) => {
    setTimeout(() => res('resolved!'), 3000);
  });
  const rejPromise = new Promise((res, rej) => {
    setTimeout(() => rej('rejected!'), 5000);
  });
  
  await resPromise;                                                                    // -> 'resolved!'     //  waits till the promise is resolved and returns the result 
  await rejPromise;                                                                    // waits till the promise is rejected which exits the program, block all furhter executesion and throws an UndhandledPromiseRejection error    
  
  console.log( '--end --' );                                                           // -! never executed because an awaited promise is rejected before this  
  </pre>
    </details>



    <br><br>
  </body>

</html>