<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title> Terragrunt </title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../Assets/stylesPages.css">
    <script src="../Assets/scriptPages.js"></script>
  </head>
  <body>
    <h1> Terragrunt </h1>
    <p> Updated: ( 2025-06-07 / 2025-09-05 ) </p>
    <nav class="sitenav">
      <a href="../index.html">MySite > </a> Terragrunt
    </nav>
    <table class="table">
      <tr>
        <th style="width:30%;"> CMD </th>
        <th> Description </th>
      </tr>
      <tr>
        <td> <a href="https://terragrunt.gruntwork.io/docs/reference/cli/" target="_blank">terragrunt cmd</a></td>
        <td> - command reference </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> terragrunt init </td>
        <td>
          - initializes the terragrunt project (<a href="https://terragrunt.gruntwork.io/docs/features/auto-init/" target="_blank">automatically called on other commands like <mark>terragrunt plan</mark>)</a><br>
          - calls <mark>terraform|tofu init</mark> under the hood
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> terragrunt validate </td>
        <td>
          - validates the <mark>terragrunt.hcl</mark> file content in the current directory
        </td>
      </tr>
      <tr>
        <td> terragrunt hcl format </td>
        <td>
          - formats the <mark>terragrunt.hcl</mark> file content in the current directory
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2"> Unit Commands </td>
      </tr>
      <tr>
        <td>
          terragrunt <opt>[options]</opt> plan|apply|destroy
        </td>
        <td>
          - processes terragrunt configs then passes them to the <mark>terraform|tofu plan|apply|destroy</mark> command <br>
          <opt>[options]</opt><br>
          - (<opt>--log-format bare</opt>) less logs<br>
          - (<opt>--parallelism <optval>nr</optval></opt>) limits the number of parallel execution threads (Default: 10)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2"> Stack Commands </td>
      </tr>
      <tr>
        <td>
          terragrunt run --all plan|apply|destroy
        </td>
        <td>
          - runs an implicit stack (runs each underlying units)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          terragrunt run --all output
        </td>
        <td>
          - displays all outputs of each units in the stack
        </td>
      </tr>
      <tr>
        <td>
          terragrunt run --all validate
        </td>
        <td>
          - syntax validates all the stack units' config files
        </td>
      </tr>
    </table>
    <br>
    <h2 class="headerSection"> Notes : </h2>

    <h2 class="headerSection"> Useful Links : </h2>
    <p><a href="https://terragrunt.gruntwork.io/docs/reference/hcl/attributes/" target="_blank"> Reference: Attributes (terragrunt.gruntwork.io) </a></p>
    <p><a href="https://terragrunt.gruntwork.io/docs/reference/hcl/blocks/" target="_blank"> Reference: Blocks (terragrunt.gruntwork.io) </a></p>
    <p><a href="https://terragrunt.gruntwork.io/docs/reference/hcl/functions/" target="_blank"> Reference: Functions (terragrunt.gruntwork.io) </a></p>
    <p><a href="https://terragrunt.gruntwork.io/docs/features/hooks/" target="_blank"> Reference: Hooks (terragrunt.gruntwork.io) </a></p>
    <h2 class="headerSection"> Remember This : </h2>

    <h2 class="headerSection"> Description and Demonstration : </h2>
    <p> - Terragrunt is a thin wrapper around Terrafrom or OpenTofu (under the hood commands <mark>terraform</mark>|<mark>tofu</mark> are executed), so esentially terragrunt is an orchestration tool that extends the capabilities of terraform|OpenTofu </p>
    <p> - Terragrunt aims to improve Terraform|OpenTofu with: </p>
    <p class="indent-lv1"> - code reusability (DRY) (encourages to create modules then reuse them) </p>
    <p class="indent-lv1"> - certalized configuration aproach </p>
    <p class="indent-lv1"> - use environment specific config </p>
    <p> - Terragrunt uses <mark>.hcl</mark> files for its configurations, it's a convention to use <mark>terragrunt.hcl</mark> for unit configs and <mark>root.hcl</mark> of root module configs </p>
    <p> - there are 2 main Terragrunt concepts: </p>
    <p class="indent-lv1"> - <mark class="mark">Unit</mark> </p>
    <p class="indent-lv2"> - single instance of infrastructure managed by Terragrunt (directory containing a <mark>terragrunt.hcl</mark> file) </p>
    <p class="indent-lv2"> - atomic -> single block contains all its dependencies <u>and backend (state file)</u> </p>
    <p class="indent-lv2"> - under the hood Terragrunt basically executes <mark>terraform <reqval>cmd</reqval></mark> command on the unit </p>
    <p class="indent-lv1"> - <mark class="mark">Stack</mark> </p>
    <p class="indent-lv2"> - a collection of units, the main idea of stacks is to execute a collection of units </p>
    <p class="indent-lv2"> - there are 2 graph types: </p>
    <p class="indent-lv3"> - <mark class="mark">implicit stack</mark> </p>
    <p class="indent-lv4"> - basically any directory where the <mark>terragrunt run --all <reqval>cmd</reqval></mark> is executed, Terragrunt does a DAG then starts executing underlying units individually </p>
    <p class="indent-lv3"> - <mark class="mark">explicit stack</mark> </p>
    <p class="indent-lv4"> - this one uses a <mark>terragrunt.stack.hcl</mark> file which dynamicaly builds units (this one is a bit more involved, but I didn't found worth learning it at the time of writing this) <a href="https://terragrunt.gruntwork.io/docs/features/stacks/#explicit-stacks-blueprint-based-generation" target="_blank">[link]</a> </p>
    <!--------------------------------------------------------------------------->
    <hr>
    <h2 class="header"> Under the Hood Mechanics </h2>
    <p> - Terragrunt builds a DAG (Direct Acyclic Grap (which is basically a dependency tree) then starts <u>executing objects in parallel</u> (when possible, depending on dependencies), this mechanics is applied on both Unit and Stack levels </p>
    <p> - the <mark>.terragrunt-cache</mark> directory is used to cache unit specific files (recommended to be added to <mark>.gitignore</mark>) </p>
    <p> - the <mark>.terragrunt-stack</mark> directory is used to cache stack specific files (recommended to be added to <mark>.gitignore</mark>) </p>
    <p> - the <mark>.terraform.lock.hcl</mark> file is used to check the provider integrity (recommended to check in the version control) </p>
    <!--------------------------------------------------------------------------->
    <hr>
    <h2 class="header"> Terragrunt project structure <a href="https://github.com/arpadpall21/terragrunt-local-DEMO-PROJECT" target="_blank">[Local Demo Terragrunt Project]</a> </h2>
    <pre>
// terragrunt's recommended project structure (demo) 
    
    my-terragrunt-project/
    ├── deployments/
    │   ├── root.hcl                                      // root module config 
    │   ├── dev/                                          // environments 
    │   │   ├── app/
    │   │   │   └── terragrunt.hcl                        // unit configs
    │   │   ├── db/
    │   │   │   └── terragrunt.hcl
    │   │   └── vpc/
    │   │       └── terragrunt.hcl
    │   ├── prod/
    │   │   ├── app/
    │   │   │   └── terragrunt.hcl
    │   │   ├── db/
    │   │   │   └── terragrunt.hcl
    │   │   └── vpc/
    │   │       └── terragrunt.hcl
    └── modules/                                          // modules (the idea is to reuse modules across environments)
        ├── app/
        │   └── main.tf
        ├── db/
        │   └── main.tf
        └── vpc/
            └── main.tf
    </pre>

    <br><br>
  </body>

</html>