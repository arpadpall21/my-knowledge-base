<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title> PowerShell </title> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../Assets/stylesPages.css"> 
    <script src="../Assets/scriptPages.js"></script>
</head>
<h1> PowerShell (ver 3.3.1) </h1>
    <p> Updated ( 2019-06-05 / 2020-01-27 )</p>
    <p class="sitenav"> <a href="../index.html">MySite></a> PowerShell </p>
<table class="table">
    <tr>
        <th colspan="2" style="background-color:firebrick;"> PowerShell </th>
        <th rowspan="2"> Description </th>
    </tr>
    <tr>
        <th> Cmdlet </th>
        <th> Alias </th>
    </tr>
    <tr>
        <td colspan="3"> General </td>
    </tr>
    <tr>
        <td> ctrl + c </td>
        <td>  </td>
        <td> stops whatever is running </td>
    </tr>
    <tr>
        <td> <strong>path/psFile.ps1</strong> </td>
        <td>  </td>
        <td> runs the specified shell script (ex: <mark>./myShellScript.ps1</mark>) </td>
    </tr>
    <tr>
        <td> $<strong>varId</strong> <small>= value</small> </td>
        <td>  </td>
        <td> gets or sets a variable </td>
    </tr>
    <tr>
        <td style="width:35%"> $PID </td>
        <td style="width:15%">  </td>
        <td style="width:50%"> returns the PID (process identifier) of the current process </td>
    </tr>
    <tr>
        <td> $ENV:<strong>environmentKey</strong><small>="<i>value</i>"</small> </td>
        <td>  </td>
        <td> gets or sets an environment variable </td>
    </tr>
    <tr>
        <td> <strong>command</strong>; <strong>command</strong> </td>
        <td>  </td>
        <td> separates commands (expressions) </td>
    </tr>
    <tr>
        <td> <strong>command</strong> | <strong>command</strong> </td>
        <td>  </td>
        <td> pipes the returned result from one command to another </td>
    </tr>
    <tr>
        <td> <strong>command</strong> | more </td>
        <td>  </td>
        <td> the returned data is printed page by page <u>(prints the remaining pages with <mark>space</mark>)</u> </td>
    </tr>
    <tr>
        <td> slmgr -dli </td>
        <td>  </td>
        <td> prints the Windows License </td>
    </tr>
    <tr>
        <td colspan="3"> General Commands </td>
    </tr>
    <tr>
        <td> Clear-Host </td>
        <td> cls | clear </td>
        <td> clears the terminal </td>
    </tr>
    <tr>
        <td> Get-Alias <i>aliasCmd</i> </td>
        <td>  </td>
        <td> - lists available aliases <br>
             - optionally returns the PowerShell command for the passed alias command (<i>aliasCmd</i>) 
        </td>
    </tr>
    <tr>
        <td> Get-Command <i>command</i> </td>
        <td> gcm </td>
        <td> - prints all available commands <br>
             - pirnts the PowerShell command if the <i>command</i> is an alias <br>
             - prints a information about the passed command (like an executable: <mark>$ > Get-Command node</mark>)   
        </td>
    </tr>
    <tr>
        <td> Get-Help <i>command</i> </td>
        <td> help </td>
        <td> - prints the help log <br>
             - prints help to the passed command (and more...) 
        </td>
    </tr>
    <tr>
        <td> Get-Host </td>
        <td> host </td>
        <td> returns an object representing the current host program (version, ect...)  </td>
    </tr>
    <tr>
        <td> Set-Item env:<strong>evnKey</strong> <strong>envVal</strong> </td>
        <td> si </td>
        <td> sets an environment variable (for the current session) </td>
    </tr>
    <tr>
        <td> Start-Transcript <i>filePath</i> </td>
        <td>  </td>
        <td> records everything in a file what happens in PowerShell from this point </td>
    </tr>
    <tr>
        <td> Write-Output <strong>obj|data</strong> </td>
        <td> echo | write  </td>
        <td> prints the object|data </td>
    </tr>
    </tr>
        <td colspan="3"> Process </td>
    </tr>
    <tr>
        <td> Get-Process <i>[processName]</i> <small>[-Id <strong>pid</strong>]</small> </td>
        <td> gps | ps </td>
        <td> - prints all running processes on the local computer <br>
             - (<i>processName</i>) gets the specified process by its name <br>
             - (<small>-Id <strong>pid</strong></small>) gets the specified process by its process number
        </td>
    </tr>
    <tr>
        <td> Start-Process <strong>filePath</strong> </td>
        <td> saps | start </td>
        <td> opens <strong>filePath</strong> with the associated program on the local computer in a new process </td>
    </tr>
    <tr>
        <td> Stop-Process <i>pid</i> <small>[-Name <strong>processName</strong>]</small> </td>
        <td> kill | spps </td>
        <td> - (<i>pid</i>) stops the specified process (by porcess id) on the local computer <br> 
             - (<small>-Name <strong>processName</strong></small>) stops the specified process by porcess name
        </td>
    </tr>
    </tr>
        <td colspan="3"> File System </td>
    </tr>
    <tr>
        <td> Add-Content <strong>filePath</strong> <strong>data</strong> </td>
        <td> ac </td>
        <td> appends the data to the file </td>
    </tr>
    <tr>
        <td> Clear-Content <strong>filePath</strong> </td>
        <td> clc </td>
        <td> deletes all file content </td>
    </tr>
    <tr>
        <td> Copy-Item <strong>srcPath destPath</strong> <small>[-Recurse]</small> </td>
        <td> copy | cp | cpi </td>
        <td> - copies the <strong>src</strong> item (file | directory) to <strong>destPath</strong> <u>(overwrites existing files at destination without warning!)</u> <br>
             - <strong>destPath</strong> can rename the copied item <br>
             - (<small>-Recurse</small>) copies all nested items 
        </td>
    </tr>
    <tr>
        <td> Get-ChildItem <i>[path] [item]</i> <small>[env:<i>key</i>] [-Recurse]</small> </td>
        <td> dir | ls | gci </td>
        <td> - (no argument) prints (returns) prints (returns) all child items in the current directory <br>
             - (<i>path</i>) prints (returns) all items in the specified directory <br>
             - (<i>item</i>) returns the targeted item(s) only (great way to filter the serach with wildcard characters) <br>
             - (<small>env:<i>key</i></small>) prints (returns) all environment variables or the <i>key</i> environment variable's value <br>
             - (<small>-Recurse</small>) gets all nested items as well 
        </td>
    </tr>
    <tr>
        <td> Get-Content <strong>filePath</strong> </td>
        <td> type | cat | gc  </td>
        <td> - prints (returns) the file's content <br>
             - the returned data can be stored in a variable then reused (ex: <mark>$myVar = Get-Content 'someFile.txt'</mark>)
        </td>
    </tr>
    <tr>
        <td> Get-ItemProperty <strong>itemPath</strong> </td>
        <td> gp </td>
        <td> gets information about the specified item (this information is automatically printed when we list items) </td>
    </tr>
    <tr>
        <td> Move-Item <strong>srcPath destPath</strong> </td>
        <td> move | mv | mi </td>
        <td> - moves the thargeted item to the destination <br> 
             - <strong>destPath</strong> can rename the item (file | directory)
        </td>
    </tr>
    <tr>
        <td> New-Item <strong>itemName</strong> <small>[-ItemType <em>file|directory</em>]</small>
        <td> ni <span style="color:#7f85a3;">(file)</span> | mkdir <span style="color:#7f85a3;">(directory)</span> 
        <td> - creates a new item (file by default) <br> 
             - (<small>-ItemType <em>file|directory</em></small>) defines the created item's type  
        </td>
    </tr>
    <tr>
        <td> Remove-Item <i>[path]</i> <small>[env:<strong>envKey</strong>]</small> </td>
        <td> del | erase | rd | ri | rm | rmdir </td>
        <td> - (<i>path</i>) deletes the specified item (file | directory) <br>
             - (<small>env:<strong>envKey</strong></small>) deletes the specified envrionment variable (for the current session)  
        </td>
    </tr>
    <tr>
        <td> Rename-Item <strong>itemPath newName</strong> </td>
        <td> ren | rni </td>
        <td> renames the specified item (file | directory) (<strong>newName</strong> defines the new name) </td>
    </tr>
    <tr>
        <td> Set-Content <strong>filePath</strong> <strong>data</strong></td>
        <td> sc </td>
        <td> - sets the content <u>(replaces existing content)</u> of a file <br>
             - the <strong>filePath</strong> can create a new file (data (content) set to the newly created file)   
        </td>
    </tr>
    <tr>
        <td> Set-Location <strong>path</strong> </td>
        <td> cd | chdir | sl  </td>
        <td> navigates to a location (<mark>\</mark> | <mark>/</mark> = root) (<mark>..\</mark> | <mark>../</mark> = parent) (<mark>.\</mark> | <mark>./</mark> = current) </td>
    </tr>
    <tr>
        <td>  </td>
        <td> tree <i>path</i> </td>
        <td> displays the directory structure graphically </td>
    </tr> 
    <tr>
        <td colspan="3"> Disk Management (Formating / Partitioning) </td>
    </tr>
    <tr>
        <td> Format-Volume <strong>driveLetter</strong> <small>[-FileSystem <strong>FAT|FAT32|exFAT|NTFS|ReFS</strong>] [-NewFileSystemLabel <strong>label</strong>]</small> </td>
        <td>  </td>
        <td> - formats the the specified disk <br>
             - (<small>-FileSystem <strong>FAT|FAT32|exFAT|NTFS|ReFS</strong></small>) file system to format <br>
             - (<small>-NewFileSystemLabel <strong>label</strong></small>) label the formated volume 
        </td>
    </tr>
    <tr>
        <td> Get-Disk <i>diskNr</i></td>
        <td>  </td>
        <td> prints (returns) OS visible disks or the specified one </td>
    </tr>
    <tr>
        <td> Get-Partition <small>[-DiskNumber <strong>nr</strong>] [-PartitionNumber <strong>nr</strong>]</small> </td>
        <td>  </td>
        <td> - (no argument) returns all disks and their partitions <br>
             - (<small>-DiskNumber <strong>nr</strong></small>) disk to return <br>
             - (<small>-PartitionNumber <strong>nr</strong></small>) partition to return D
        </td>
    </tr>
    <tr>
        <td> Get-PhysicalDisk </td>
        <td>  </td>
        <td> prints (returns) all physical disks </td>
    </tr>
    <tr>
        <td> Get-Volume <i>driveLetter</i> </td>
        <td>  </td>
        <td> 
            - (no argument) gets (returns) all volumes (total size, free space, file system type) <br> 
            - <i>driveLetter</i> gets (returns) the specified volume
        </td>
    </tr>
    <tr>
        <td> New-Partition <small>[-DiskNumber <strong>nr</strong>] [-Size <strong>nr</strong>KB|MB|GB|TB] [-UseMaximumSize] [-AssignDriveLetter] [-NewDriveLetter <strong>dirveLetter</strong>]</small> </td>
        <td>  </td>
        <td>  
             - creates a new partition <br>
             - (<small>-DiskNumber <strong>nr</strong></small>) targets a disk by its number <br>
             - (<small>-Size <strong>nr</strong>KB|MB|GB|TB</small>) specifies the new partition size <u>in bytes if no size value specified</u> <br>
             - (<small>-UseMaximumSize</small>) uses the maximum available space to create a new partition <br>
             - (<small>-AssignDriveLetter</small>) automatically assigns a drive letter to the newly created partition <u>(not explicity assigned drive letter)</u>  <br>
             - (<small>-NewDriveLetter <strong>driveLetter</strong></small>) <u>explicitly sets a drive letter to the created partition</u>
        </td>
    </tr>
    <tr>
        <td> Remove-Partition <small>[-DiskNumber <strong>nr</strong>] [-PartitionNumber <strong>nr</strong>] [-DirveLetter <strong>driveLetter</strong>]</small> </td>
        <td>  </td>
        <td>  
             - removes a partition <br>
             - (<small>-DiskNumber <strong>nr</strong></small>) targets a disk by its number <br>
             - (<small>-PartitionNumber <strong>nr</strong></small>) partition to remove <br>
             - (<small>-DirveLetter <strong>driveLetter</strong></small>) removes the partition associated with the specified drive letter <br>
        </td>
    </tr>
    <tr>
        <td> Resize-Partition <small>[-DiskNumber <strong>nr</strong>] [-PartitionNumber <strong>nr</strong>] [-DirveLetter <strong>driveLetter</strong>] [-Size <strong>nr</strong>KB|MB|GB|TB]</small></td>
        <td>  </td>
        <td>  
             - resizes the specified partition <br>
             - (<small>-DiskNumber <strong>nr</strong></small>) targets a disk by its number <br>
             - (<small>-PartitionNumber <strong>nr</strong></small>) partition to resize <br>
             - (<small>-DirveLetter <strong>driveLetter</strong></small>) drive to resize <br>
             - (<small>-Size <strong>nr</strong>KB|MB|GB|TB</small>) set new size 
        </td>
    </tr>
    <tr>
        <td> Set-Partition <small>[-DiskNumber <strong>nr</strong>] [-PartitionNumber <strong>nr</strong>] [-DriveLetter <strong>driveLetter</strong>] [-NewDriveLetter <strong>diriveLetter</strong>]</small></td>
        <td>  </td>
        <td>  
             - sets the specified partition <br>
             - (<small>-DiskNumber <strong>nr</strong></small>) targets a disk by its number <br>
             - (<small>-PartitionNumber <strong>nr</strong></small>) partition to set <br>
             - (<small>-DriveLetter <strong>driveLetter</strong></small>) targets the partition specified by the drive letter <br>
             - (<small>-NewDriveLetter <strong>driveLetter</strong></small>) <u>explicitly sets a letter to the specified partition</u>
        </td>
    </tr>
    <tr>
        <td> Set-Volume <em>[-DriveLetter <strong>DriveLetter</strong>]</em> <em>[-NewFileSystemLabel <strong>label</strong>]</em> </td>
        <td>  </td>
        <td> 
             - sets the specified volume's label <u>(<strong>driveLetter</strong> must be specified as block letter)</u> <br>
             - on FAT File Systems label max length is 11 characters and the <mark>*</mark> <mark>?</mark> <mark>.</mark> <mark>,</mark> <mark>;</mark> <mark>:</mark> <mark>/</mark> <mark>\</mark> <mark>|</mark> <mark>+</mark> <mark>=</mark> <mark>&lt;</mark> <mark>&gt;</mark> <mark>[</mark> <mark>]</mark>
         characters are not allowed <br>
             - on NTFS File Systems lable max length is 32 characters 
        </td>
    </tr>
    <tr>
        <td colspan="3"> Networking </td>
    </tr>
    <tr>
        <td> Invoke-Webrequest <strong>webUrl</strong> <small>[-OutFile <strong>file</strong>]</small> </td>
        <td> curl | iwr | wget </td>
        <td>  
            - gets the content of the specified web page from the internet <br>
            - (-OutFile <strong>file</strong>) saves the response body in the specified file 
        </td>
    </tr>
    <tr>
        <td> ipconfig <small>[/all] [/displaydns] [/flushdns]</small> </td>
        <td>  </td>
        <td> 
             - (no argument) retuns the current TCI/IP configuration <br>
             - (<small>/all</small>) displays the full configuration of all adapters <br>
             - (<small>/displaydns</small>) displays the DNS resolver cache <br>
             - (<small>/flushdns</small>) flushes the DNS cache 
        </td>
    </tr>
    <tr>
        <td> netstat <small>[/?] [-a] [-p <strong>protocol</strong>] [-o] [-b] [-f] [-n]</small></td>
        <td>  </td>
        <td>  
             - (no argument) returns all TCP connections with IP addresses, ports and connection state <br>
             - (<small>/?</small>) option list <br>
             - (<small>-a</small>) displays all connections and listening ports (UDP included) <br>
             - (<small>-p <strong>protocol</strong></small>) prints connections for the specified protocol only(<strong>protocol</strong> = <mark>tcp</mark>|<mark>udp</mark>|<mark>tcpv6</mark>|<mark>udpv6</mark>) <hr>
             - (<small>-o</small>) displays active connections with the corresponding PIDs <br>
             - (<small>-b</small>) displays active connections with the corresponding process names <br>
             - (<small>-f</small>) displays FQDN (Fully Qualified Domain Name) for IP addresses <br>
             - (<small>-n</small>) displays IP's for foreign addresses (not FQDN) 
        </td>
    </tr>
    <tr>
        <td> ping <small>[/?] [<i>ipAddress|nameAddress</i>] [localhost]</small> </td>
        <td>  </td>
        <td> 
             - tests the connection between this computer and the specified target <br>
             - sends 4 data packtes in order to test the response rate <br>
             - pinging names also test DNS (returns the specified name's IP address) <br>
             - (<small>/?</small>) option list <br>
             - (<small>localhost|127.0.0.1</small>) loopback test = test the local network adapter
        </td>
    </tr>
    <tr>
        <td> Resolve-DnsName <strong>domainName|ipAddress</strong> </td>
        <td>  </td>
        <td>  
             - (<strong>domainName</strong>) resolves a domain name to ip addresses (DNS lookup) (ex: <mark>google.com</mark> | <mark>www.google.com</mark>) <br>
             - (<strong>ipAddress</strong>) resolves an ip address (IPv4 or IPv6) to domain names
        </td>
    </tr>
    <tr>
        <td> tracert <small>[/?] [<i>ipAddress|nameAddress</i>]</small></td>
        <td>  </td>
        <td>  
             - returns the route to the specified destination <br>
             - (<small>/?</small>) option list <br>
        </td>
    </tr>
</table>
    <br>
<table class="table">
<caption> Wildcard Characters (Globs) <u>(case-insensitive)</u> </caption>
    <tr>
        <th style="width:30%;"> Wildcard </th>
        <th> Description </th>
    </tr>
    <tr>
        <td> * </td>
        <td> matches zero or more characters (any character) </td>
    </tr>
    <tr>
        <td> ? </td>
        <td> matches one character (any character) </td>
    </tr>
    <tr>
        <td> [<strong>char</strong>-<strong>char</strong>] </td>
        <td> matches one character (any of the specified range (ex: <mark>[a-e]</mark> matches <mark>a</mark> <mark>b</mark> <mark>c</mark> <mark>d</mark> <mark>e</mark>)) </td>
    </tr>
    <tr>
        <td> [<strong>char</strong>...] </td>
        <td> matches one character (any of the enclosed characters (ex: <mark>[aex]</mark> matches <mark>a</mark> <mark>e</mark> <mark>x</mark>)) </td>
    </tr>
</table>
    <br>
<table class="table">
<caption> File Mods </caption>
    <tr>
        <th style="width:30%;"> Mode </th>
        <th> Description </th>
    </tr>
    <tr>
        <td> d----- </td>
        <td> directory </td>
    </tr>
    <tr>
        <td> -a---- </td>
        <td> archive (file) </td>
    </tr>
    <tr>
        <td> --r--- </td>
        <td> read-only </td>
    </tr>
    <tr>
        <td> ---h-- </td>
        <td> hidden </td>
    </tr>
    <tr>
        <td> ----s- </td>
        <td> system </td>
    </tr>
    <tr>
        <td> -----l </td>
        <td> symlink, release point, ect... </td>
    </tr>    
</table>
<h2 class="headerSection"> Notes : </h2>
    <details class="example" id="notes">
    <summary> Notes :</summary>
    <!-- <p> - paragraph removes the 'empty' message from the detail TAG -->
    </details>
<h2 class="headerSection"> Useful Links : </h2>
    <p><a href="https://www.pdq.com/powershell/" target="_blank"> PDQ.com PowerShell command list </a></p>
    <p><a href="https://docs.microsoft.com/en-us/powershell/module/?view=win10-ps" target="_blank"> Microsoft PowerShell </a></p>
<h2 class="headerSection"> Remember This : </h2>
    <p> - [TESTED: 2020-01-27] apparently we cannot get the environment variables of a running process, I tried the <mark>(Get-Process processName).StartInfo.EnvironmentVariables</mark> command but it appears to return the same as the <mark>ls env:</mark> command </p>
<h2 class="headerSection"> Description and Demonstration : </h2>
    <p> - PowerShell is an task automation and configuration management command-line shell framework built on <mark>.NET</mark> </p>
    <p> - it's a scripting language mainly developed for Windows by Microsoft (from 2016-08-18 became open-source and cross-platform) </p>
    
<br><br>
</body>
</html>