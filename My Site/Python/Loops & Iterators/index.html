<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title> Loops & Iterators </title> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../../Assets/stylesPages.css"> 
    <script src="../../Assets/scriptPages.js"></script>
</head>
<body>
<h1> Loops & Iterators </h1>
    <p> Updated ( 2022-03-22 / 2024-09-05 )</p>
    <nav class="sitenav"> <a href="../../index.html">MySite > </a>
        <a href="../index.html">Python > </a> Loops & Iterators
    </nav>
<table class="table">
    <tr>
        <th style="width:30%;"> Method / Attribute </th>
        <th> Description </th>
    </tr>
    <tr>
        <td> 
            iter(<strong>iterable</strong>)
        </td>
        <td> 
            - from an <strong>interable</strong> creates and returns an <strong>iterator</strong> object
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
        <td> 
            <strong>iterator|generator</strong>.__iter__
        </td>
        <td> 
            - object is <strong>iterator</strong> or <strong>generator</strong> if has the <mark>__iter__</mark> method (this is how we can check)
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
        <td> 
            <strong>iterator|generator</strong>.__next__()
        </td>
        <td> 
            - yields the next member of <strong>iterator</strong> <br>
            - if overcalled raises a <mark>StopIteration</mark> error
                <span id="browserSupport" title="Updated: 2022-03-23">
                    <span><i class="fab fa-python"></i> 3.x </span>
                </span>
        </td>
    </tr>
    <tr>
        <td> 
            next(<strong>iterator|generator</strong>, <i>default:any</i>)
        </td>
        <td> 
            - yields the next member of <strong>iterator</strong> <br>
            - if overcalled yields <i>default</i> (if <i>def</i> is not specified raises a <mark>StopIteration</mark> error)
            <span id="browserSupport" title="Updated: 2022-03-23">
                <span><i class="fab fa-python"></i> 2.6 </span>
            </span>
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
        <td> 
            range(<i>stIdx(inc):int</i>, <strong>endIdx(exc):int</strong>, <i>steps:int</i>)
        </td>
        <td> 
            - creates and returns a sequence between the specified index range (used in <mark>for</mark> loops to control cycles) 
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
      <td colspan="2"> Async </td>
    </tr>
    <tr>
        <td> 
            aiter(<reqval>asyncIterable</reqval>)
        </td>
        <td> 
            - from an <reqval>asyncIterable</reqval> returns an <reqval>asyncIterator</reqval> object
            <span id="browserSupport" title="Updated: 2025-01-09">
                <span><i class="fab fa-python"></i> 3.10 </span>
            </span>
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
        <td> 
            <reqval>asyncIterator|asyncGenerator</reqval>.__aiter__
        </td>
        <td> 
            - object is an <reqval>asyncIterator</reqval> or <reqval>asyncGenerator</reqval> if it has this property
        </td>
    </tr>
    <tr>
      <td>|</td>
      <td></td>
    </tr>
    <tr>
        <td> 
            <strong>asyncIterator|asyncGenerator</strong>.__anext__()
        </td>
        <td> 
            - yields the next member of <strong>asyncIterator|asyncGenerator</strong> <br>
            - if overcalled raises a <mark>StopAsyncIteration</mark> error
        </td>
    </tr>
    <tr>
        <td> 
            anext(<strong>iterator|generator</strong>)
        </td>
        <td> 
            - yields the next member of <strong>asyncIterator|asyncGenerator</strong> <br>
            - if overcalled raises a <mark>StopAsyncIteration</mark> error
            <span id="browserSupport" title="Updated: 2025-01-09">
                <span><i class="fab fa-python"></i> 3.10 </span>
            </span>
        </td>
    </tr>
</table>
    <br>
<h2 class="headerSection"> Useful Links : </h2>
    <p><a href="https://docs.python.org/3/tutorial/classes.html#iterators" target="_blanc">Iterators (docs.python)</a></p>
<h2 class="headerSection"> Remember This : </h2>
    
<h2 class="headerSection"> Description and Demonstration : </h2>
<h2 class="header"><u> The <mark>while</mark> / <mark>for in</mark> loop and <mark>continue</mark> / <mark>break</mark> keywords</u> </u></h2>
    <pre class="syntax">
<span style="color:darkgray;">// while loop -------------------------------------------------------------------------</span>
    while <strong>cond</strong>:                                                                        // while the condition is true runs a loop cycle and check the condition again 
        <strong>codeBlock</strong>                                                
    <small>else:</small>                                                                              // once the loop is over runs this code block (does not run if the loop was stopped by <mark>break</mark>)    
        <i>codeBlock</i>
    
    
<span style="color:darkgray;">// for in loop ------------------------------------------------------------------------</span>
    for <strong>item</strong> in <strong>iterable</strong>                                                               // runs a cycle for each item in the iterable  
        <strong>item</strong>                                                                           // current item 
    <small>else:</small>                                                                              // once the loop is over runs this code block (does not run if the loop was stopped by <mark>break</mark>)    
        <i>codeBlock</i>
    
    
<span style="color:darkgray;">// <mark>continue</mark> / <mark>break</mark> -------------------------------------------------------------------</span>
    <strong>loop</strong>
        continue                                                                       // skips this loop cycle and jupst into the next one (the remaining code block is skipped)
        break                                                                          // ends the loop completetly  
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
// while loop -------------------------------------------------------------------------
    x = 5
    
    while x > 0:
        x                                                                              // -> 5  |  4  |  3  |  2  |  1
        x -= 1
    else:
        print( 'end of loop')                                                          // code block executed at the end of the while loop    
    
    
// for in loop ------------------------------------------------------------------------
    list = [1, 2, 3]
    
    for i in list:
        i                                                                              // -> 1  |  2  |  3 
    else:
        print( 'end of loop')                                                          // code block executed at the end of the while loop    
    
    
// continue / break -------------------------------------------------------------------
    x = 5
    
    while True:
        x -= 1
        
        if x == 2 or x == 4:
            continue                                                                   // skips the cyle (the remaining clode block)  
        
        x                                                                              // -> 3  |  1  |  0  
        
        if x &lt;= 0:
            break                                                                      // breaks the loop 
    </pre>
</details>
<!---------------------------------------------------------------------------------------------->
<hr>
<h2 class="header"><u> list|dictionary|set of comprehension </u></h2>
    <p> - Python offers a fancy way of looping through iterables filtering them and creating a list, dictionary, set </p>
    <pre class="syntax">
    [<strong class="openable">i<div>
                <p> - expression recevies the current <strong>item</strong> </p>
                <p> - we can perform some operation on the returned item before returning it in the new list (ex: <mark><strong>item</strong>.lower()</mark>) </p>
            </div></strong> for <reqval class="openable">i<div>
                <p> - the current item variable </p>
            </div></reqval> in <strong>iterable</strong> <small>[if <i class="openable">cond<div>
                <p> - if the condition is <mark>True</mark> the item is stored in the new list </p>
            </div></i>]</small>]                                                // list of comprehension, returns a <strong>list</strong> of the filtered results
    {<strong class="openable">i<div>
                <p> - expression recevies the current <strong>item</strong> </p>
                <p> - we can perform some operation on the returned item before returning it in the new list (ex: <mark><strong>item</strong>.lower()</mark>) </p>
            </div></strong> for <reqval class="openable">i<div>
                <p> - the current item variable </p>
            </div></reqval> in <strong>iterable</strong> <small>[if <i class="openable">cond<div>
                <p> - if the condition is <mark>True</mark> the item is stored in the new list </p>
            </div></i>]</small>}                                                // set of comprehension, returns a <strong>set</strong> of the filtered results    
    
    {<strong class="openable">i:val<div>
                <p> - expression recevies the current <strong>item</strong> </p>
                <p> - we can perform some operation on the returned item before returning it in the new list (ex: <mark><strong>item</strong>.lower()</mark>) </p>
            </div></strong> for <reqval class="openable">i<div>
                <p> - the current item variable </p>
            </div></reqval> in <strong>iterable</strong> <small>[if <i class="openable">cond<div>
                <p> - if the condition is <mark>True</mark> the item is stored in the new list </p>
            </div></i>]</small>}                                            // dictionary of comprehension, returns a <strong>dict</strong> of the filtered results    
                                                                                       // the 1st expression is a key:val pair -> dictionary of comprehension instead of set of comprehension 
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
    [i for i in range(1, 6)]                // -> [1, 2, 3, 4, 5]                    // list of comprehension
    {i for i in range(1, 6)}                // -> {1, 2, 3, 4, 5}                    // set of comprehension
    {i:i for i in range(1, 6)}              // -> {1: 1, 2: 2, 3: 3, 4: 4, 5: 5}     // dictionary of comprehension    // -! 1st expression is a key:val pair
    (i for i in range(1, 6))                // -! tuple of comprehension is not possible this returns an iterator
    
// filtering --------------------------------------------------------------------
    [i for i in range(1, 21) if i % 2 == 0] // -> [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]   // even numbers only
    </pre>
</details>
<!---------------------------------------------------------------------------------------------->
<hr>
<h2 class="header"><u> Custom Iterator Implementation </u></h2>
    <p> - internally loops call the <mark>iter()</mark> method on the iterable object which returns an iterator object, then they call the <mark>next()</mark> method on the iterator object until the <mark>StopIteration</mark> error is raise to stop the iteration </p>
    <p> - armed with this knowledge we can implement our own iterator type with the <mark>__iter__()</mark> and <mark>__next__()</mark> methods </p>
    <pre class="syntax">
    class <strong>classId</strong>:
        def __init__(self):
            <strong>codeBlock</strong>
            
        def __iter__(self):                                                            // logic to setup the iterator type  
            <strong>codeBlock</strong>
            
        def __next__(self):                                                            // logic to call for each iteration 
            raise StopIteration                                                        // we raise the <mark>StopIteration</mark> error when we want the end the cycles  
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
    class MyIterator:
        def __init__(self, data):
            self.data = data
            self.index = 0
            self.end = len(data)
        
        def __iter__(self):
            return self
        
        def __next__(self):
            if self.index >= self.end:
                raise StopIteration
            item = self.data[self.index]
            self.index += 1
            return item
    
    
    iteratorInstance = MyIterator('abc')                                               // the custom iterator type   
    
// get iterator's items ---------------------------------------------------------------
    for i in iteratorInstance:
        i                                                                              // -> 'a'  |  'b'  |  'c'  
    
    iteratorObj = iter(iteratorInstance)
    
    next(iteratorObj)                                                                  // -> 'a'
    next(iteratorObj)                                                                  // -> 'b'
    next(iteratorObj)                                                                  // -> 'c'
    next(iteratorObj)                                                                  // -! raises the StopIteration error (iterator object overcalled)   
    </pre>
</details>
<!---------------------------------------------------------------------------------------------->
<hr>
<h2 class="header"> Generator (function) </h2>
    <p> - the generator (function) is the play|pause interface in python </p>
    <pre class="syntax">
    def <reqval>genFn</reqval>():                                                                     // function having the <mark>yield</mark> keyword becomes a generator
        yield <strong>exp</strong>                                                                      // calling the <mark>next()</mark> method on the returned <strong>iterator</strong> will yield the value after the <mark>yield</mark> keyword <u>then pauses the generator execution until the <mark>next()</mark> is called again</u>    
        
        yield from <strong>genObj|iterable</strong>                                                     // delegates to another generator or iterable object to call their members     
        
        return <strong>val</strong>                                                                     // the <mark>return</mark> value is raised as <mark>StopIteration</mark> error value if the <strong>genObj</strong> is overcalled 
    
    
    <strong>generator</strong> = <reqval>genFn</reqval>()                                                               // create generator
                                                                                    
// consuming ----
    for <reqval>member</reqval> i <reqval>generator</reqval>:             // loop 
        <reqval>member</reqval>
    
    next(<reqval>generator</reqval><optval>, defVal</optval>)         // get next member 
    <reqval>generator</reqval>.__next__()                   
    </pre>
    <pre class="syntax">
    async def <reqval>asyncGenFn</reqval>():                            // <span class="browserSupport" style="color: yellow;"><span><i class="fab fa-python"></i> 3.6 </span></span> async generator function
        <opt>await <optval>awaitable</optval></opt>                     // awaiting awaitables ...
        yield <reqval>exp</reqval>
    
        return <strong>val</strong>                                                                     // the <mark>return</mark> value is raised as <mark>StopIteration</mark> error value if the <strong>genObj</strong> is overcalled 
    
    
    <reqval>asyncGenerator</reqval> = <reqval>asyncGenFn</reqval>()     // create async generator
    
// consuming ----
    async for <reqval>member</reqval> i <reqval>asyncGenerator</reqval>:    // async loop 
        <reqval>member</reqval>
    
    await anext(<reqval>asyncGenerator</reqval>)                        // <span class="browserSupport" style="color: yellow;"><span><i class="fab fa-python"></i> 3.10 </span></span> get next member
    await <reqval>asyncGenerator</reqval>.__anext__()                   // get next member 
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
    def genFn():
        yield 'one'
        yield 'two'
        return 'three'                                                                 // the return value is not part of the generated values   
    
    genObj = genFn()                                                                   // returns a generator object    
    
// looping through the generator object -----------------------------------------------
    for i in genObj:
        i                                                                              // -> 'one'  |  'two'
    
// .next() ----------------------------------------------------------------------------
    genObj.__next__()                                                                  // -> 'one'
    genObj.__next__()                                                                  // -> 'two'
    genObj.__next__()                                                                  // -! raises <mark>StopIteration: three</mark> error (the generator function return value is the error value here)    
    
// next() -----------------------------------------------------------------------------
    next(genObj, 'defVal')                                                             // -> 'one'
    next(genObj, 'defVal')                                                             // -> 'two'
    next(genObj, 'defVal')                                                             // -> 'defVal'     // return the default value instead of raising the StopIteration error   
    </pre>
    <hr>
    <!---------------------------------------------------------------------------------------->
    <h4 class="header"> Delegating with <mark>yield from</mark> </h4>
    <pre>
    def sub_generator():
        yield 11
        yield 12
        yield 13
    
    
    def main_generator():
        yield 'Start'
        yield from sub_generator()
        yield 'End'
    
    
    for i in main_generator():
        i                     // -> 'Start', 11, 12, 13, 'End'    
    </pre>
    <hr>
    <!---------------------------------------------------------------------------------------->
    <h4 class="header"> Async Generator </h4>
    <pre>
    import asyncio
    
    
    async def my_asgen():                       // creating async generator
        for i in range(10):
            await asyncio.sleep(1)
            yield i
    
    async def main():
        async for i in my_asgen():           // execute async generator
            i                                 // -> 0  |  1  |  ....
    
    asyncio.run(main())
    </pre>
</details>
<!---------------------------------------------------------------------------------------------->
<hr>
<h2 class="header"> The <mark>__iter__</mark> / <mark>iter()</mark> / <mark>__next__()</mark> / <mark>next()</mark> / <mark>range()</mark> / <mark>__anext__()</mark> / <mark>anext()</mark> attribute and methods </h2>
<details class="example">
<summary> DEMO </summary>
    <h4 class="header"> The <mark>__iter__</mark> / <mark>iter()</mark> / <mark>__next__()</mark> / <mark>next()</mark> / <mark>range()</mark> proeprty and methods </h4>
    <pre>
// __iter__ ---------------------------------------------------------------------------
    str = 'someString'
    someFloat = 2.2
    
    hasattr(str, '__iter__')                                                           // -> True             // iterable 
    hasattr(someFloat, '__iter__' )                                                    // -> False            // not iterable 
    
    
// iter() / __next__() / next() -------------------------------------------------------
    def genFn():
        yield 'one'
        yield 'two'
    
    genObj = genFn()
    iterObj = iter([1, 2])                                                             // creates and returns an iterator 
    
    genObj.__next__()                                                                  // -> 'one'        // returns the next member in the iterator 
    next(genObj)                                                                       // -> 'two'        // returns the next member in the iterator 
    genObj.__next__()                                                                  // -! raises a StopIteration error (becaus of orvercall)   
    
    iterObj.__next__()                                                                 // -> 1            // on generator object does the same 
    next(iterObj, 'defVal')                                                            // -> 2
    next(iterObj, 'defVal')                                                            // -> 'defVal'     // retuns the default value (because of overcall)
    next(iterObj, 'defVal')                                                            // -> 'defVal'
    
    
// range() ----------------------------------------------------------------------------
    for i range(3):                                                                    // creates and returns a range with 3 members      // this is the same as <mark>range(0, 3, 1)</mark> (starts with <mark>0</mark> index)   
        i                                                                              // -> 0  |  1  |  2
    
    for i in range(2, 11, 2):
        i                                                                              // -> 2  |  4  |  6  |  8    
    
    for i in range(0, 21, 7):
        i                                                                              // -> 0  |  7  |  14
    </pre>
    <!-------------------------------------------------------------------------->
    <hr>
    <h4 class="header"> The <mark>__aiter__</mark> / <mark>__anext__()</mark> / <mark>anext()</mark> property and methods </h4>
    <pre>
    import asyncio
    
    
    async def my_asgen():
        for i in range(10):
            await asyncio.sleep(1)
            yield i
    
    asyncGen = my_asgen()                   // creates async generator
    asyncGen.__aiter__                      // has <mark>__aiter__</mark> property (means it's an async iterator or generator)
    
    async def main():
    
        await anext(asyncGen)
        await asyncGen.__anext__()
        await anext(asyncGen)
        await asyncGen.__anext__()
    
    
    asyncio.run(main())
    </pre>
</details>
    
    
    <br><br>
</body>
</html>
