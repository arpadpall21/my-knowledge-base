<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> Basics and CLI </title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="../../Assets/stylesPages.css">
    <script src="../../Assets/scriptPages.js"></script>
  </head>
  <body>
    <h1> Basics and CLI (ver 4.0.0) </h1>
    <p> Updated ( 2021-02-08 )</p>
    <p class="sitenav"> <a href="../../index.html" title="home">MySite></a>
      <a href="../index.html">Webpack></a> Basics and CLI
    </p>
    <table class="table">
      <caption>
        CLI
        <span class="changeListOrder">[Ordered: <span>Alphabetically</span>]</span>
      </caption>
      <tr>
        <th style="width:30%;"> Method / Property / statement ect... </th>
        <th> Description </th>
      </tr>
      <tr class="00.01">
        <td>
          <em>$</em> install webpack
        </td>
        <td>
          - insalls webpack
        </td>
      </tr>
      <tr class="00.02">
        <td>
          <em>$</em> install webpack-cli
        </td>
        <td>
          - insalls the webpack command line interface
        </td>
      </tr>
      <tr class="00.03">
        <td>
          <em>$</em> install webpack-dev-server
        </td>
        <td>
          - insalls the webpack development server
        </td>
      </tr>
      <tr class="01.00">
        <td colspan="2">
          Commands
        </td>
      </tr>
      <tr class="05.01">
        <td>
          <em>$ npx webpack</em> build <small>[--entry <i>filePath</i>]</small> <small>[--output-path <i>filePath</i>]</small> <small>[--env <i>key=val</i>]</small> <small>[--node-env <i>val</i>]</small> <small>[--config <i>filePath</i>]</small> <small>[--mode=production|developemnt|none]</small> <small>[--progress]</small>
        </td>
        <td>
          - runs webpack (compiles the set bundle) (Default command <mark>npx webpack</mark> does the same) <br>
          - (<small>--entry</small>) sets the entry (top-level module) of the bundle (takes precedence over the config file)<br>
          - (<small>--output-path</small>) sets the output of the result bundle (creates directories and the output file) (takes precedence over the config file)<br>
          - (<small>--env</small>) passes a key/value pair as environment value to the config file, received in the config file's <mark>module.exports</mark> function argument (used to pass configuration values in the config file) <br>
          - (<small>--node-env</small>) passes a value to the <mark>process.env.NODE_ENV</mark> <u>which is received only in the config file</u> (used to pass configuration values in the config file) <br>
          - (<small>--config</small>) configuration file to use (Default: <mark>./webpack.config.js</mark>) <br>
          - (<small>--mode</small>) sets the webpack bundler environment mode (takes precedence over the config file) <br>
          - (<small>--progress</small>) prints compilation progress during the build <br>
          - aliases <mark>bundle</mark> | <mark>b</mark>
        </td>
      </tr>
      <tr class="06.01">
        <td>
          <em>$ npx webpack</em> configtest <i>filePath</i>
        </td>
        <td>
          - test the specified file if it's a valid webpack configuration file (Default: <mark>./webpack.config.js</mark>)
        </td>
      </tr>
      <tr class="01.01">
        <td>
          <em>$ npx webpack</em> help <i>cmd</i>
        </td>
        <td>
          - prints the list of available commands (or the specified one)
        </td>
      </tr>
      <tr class="02.01">
        <td>
          <em>$ npx webpack</em> init
        </td>
        <td>
          - initializes a webpack project (installs necessary webpack modules and sets up *.json files)
        </td>
      </tr>
      <tr class="01.02">
        <td>
          <em>$ npx webpack</em> info
        </td>
        <td>
          - prints OS informations and webpack informations (like version and installed packages)
        </td>
      </tr>
      <tr class="07.01">
        <td>
          <em>$ npx webpack</em> serve
        </td>
        <td>
          - starts the wepback-dev-server
        </td>
      </tr>
      <tr class="01.03">
        <td>
          <em>$ npx webpack</em> version
        </td>
        <td>
          - prints the webpack, webpack-cli and webpack-dev-server versions
        </td>
      </tr>
      <tr class="08.01">
        <td>
          <em>$ npx webpack</em> watch
        </td>
        <td>
          - starts webpack watch mode (files in the current and all nested directories are watched) <br>
          - if there's a changed webpack automatically recompiles the bundle
        </td>
      </tr>
    </table>
    <h2 class="headerSection"> Remember This : </h2>
    <p> - from Webpack v5 we can use Web Workers in Webpack (in the top-level module)</p>
    <p> - I tried to set up Webpack with React but it does not work properly [2021-03-02], I blogged about this topic but apparently we should not use React with Webpack </p>
    <h2 class="headerSection"> Useful Links : </h2>
    <p><a href="https://webpack.js.org/" target="_blank"> Webpack (webpack.js.org) </a></p>
    <h2 class="headerSection"> Remember This : </h2>
    <p> - the prefered way to run webpack CLI commands is setting them up in the <mark>package.json</mark> file's <mark>script</mark> field then run the preset command through <mark>npm run &lt;cmd&gt;</mark> </p>
    <h2 class="headerSection"> Description and Demonstration : </h2>
    <p> - at its core Webpack is a static module bundler (internally builds a dependency graph then buldes all that into a single file) </p>
    <p> - but Webpack is much more than a bundler, can be used as sort of task runner, can dynamically generate HTML documents and inject code in it, and much much more </p>
    <p> - through Webpack we can configure a fine grained front-end developement environment which is when compiled results in distribution version </p>
    <hr>
    <!--------------------------------------------------------------------------------------------------------------->
    <h2 style="color:darkblue;"><u> Concepts </u></h2>
    <p class="concept"> Entry : </p>
    <p class="conceptPoint"> - entry point (top-level module) this is from where Webpack starts to build the internal dependency graph (Default: <mark>./src/index.js</mark>) </p>
    <p class="concept"> Output : </p>
    <p class="conceptPoint"> - the output bundle (the result of the bundling process) (Default: <mark>./dist/main.js</mark>) </p>
    <p class="concept"> Loaders : </p>
    <p class="conceptPoint"> - out of the box Webpack 'understands' only <mark>*.js</mark> and <mark>*.json</mark> files </p>
    <p class="conceptPoint"> - a loader can read non JavaScript code 'translate' and load as module into Webpack (preprocesses the file) </p>
    <p class="conceptPoint"> - ex: <mark>css-loader</mark> loads CSS, <mark>bable-loader</mark> loads ES6 code to ES5 </p>
    <p class="concept"> Plugins : </p>
    <p class="conceptPoint"> - plugins do 'things' during the compilation process </p>
    <p class="conceptPoint"> - ex: <mark>HtmlWebpackPlugin</mark> creates an HTML file, <mark>TerserPlugin</mark> minifies JS </p>
    <p class="concept"> Mode : </p>
    <p class="conceptPoint"> - optimizes the bunlde for development or production environment </p>
    <p class="conceptPoint"> - ex: for production the code is minified </p>
    <p class="concept"> Browser Compatibility : </p>
    <p class="conceptPoint"> - Webpack v5 runs on node.js v10.13.0 and supports all major browsers (IE9 onwards) </p>
    <hr>
    <!--------------------------------------------------------------------------------------------------------------->
    <h2 class="headerExtra"><u> Module syntax <mark></u></h2>
      <p> - Webpack supports <mark>ECMAScript module</mark>, <mark>CommonJS</mark> and <mark>AMD</mark> module syntax in all its modules</p>
      <details class="example">
        <summary> DEMO </summary>
        <pre>
    let module1 = require('./module1.js');                                             // CommonJS syntax
    import {x, y} from './module2.js';                                                 // ECMAScipt module syntax 
    
    module1.a                                                                          // -> 21
    module1.b                                                                          // -> 22
    
    x                                                                                  // -> 121
    y                                                                                  // -> 121
    </pre>
        <p> <mark>module1.js</mark> Entry file </p>
        <pre>
    exports.a = 21;
    exports.b = 22;
    </pre>
        <p> <mark>module2.js</mark> Entry file </p>
        <pre>
    export let x = 121, y = 122;    
    </pre>
      </details>
      <details class="example">
        <summary> Example : </summary>
        <h4 style="color:darkblue;"><u> Webpack module syntax TEST </u></h4>
        <p> <mark>index.js</mark> Entry file </p>
        <pre>
    let module1 = require('./module1.js');
    import {x, y} from './module2.js';
    
    console.log( module1.a );                                                          // -> 21
    console.log( module1.b );                                                          // -> 22
    
    console.log( x );                                                                  // -> 121
    console.log( y );                                                                  // -> 121
    </pre>
        <p> <mark>module1.js</mark> Entry file </p>
        <pre>
    exports.a = 21;
    exports.b = 22;
    </pre>
        <p> <mark>module2.js</mark> Entry file </p>
        <pre>
    export let x = 121, y = 122;    
    </pre>
      </details>
      <hr>
      <!--------------------------------------------------------------------------------------------------------------->
      <h2 class="headerExtra"><u> CLI <mark>build</mark> / <mark>configtest</mark> / <mark>help</mark> / <mark>info</mark> / <mark>version</mark> / <mark>serve</mark> / <mark>watch</mark> </u></h2>
      <details class="example">
        <summary> DEMO </summary>
        <p style="color:darkblue;"><u> <mark>build</mark> </u></p>
        <pre class="cmd">
    pall@Ryzen:~/myProject$ npx webpack                                                // omitting a command falls back to 'build' (same as '$ npx webpack build')     
        // ...
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/myProject$ npx webpack build --entry ./src/myIndex.js --output-path ./dist/myBundle.js    // entry and output set (takes precedence over the entry and ouput in the config file)    
        // ...
        
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/myProject$ npx webpack build --config ./custom.config.js              // sets the configuration file to use 
        // ... 
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/myProject$ npx webpack --mode=production                              // runs the webpack bundler in production mode (takes precedence over the production mode in the config file)    
        // ...
    </pre>
        <p> <mark>build --env</mark> </p>
        <pre class="cmd">
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack build --env myVal=dev    // passes a key/value pair in the config file (redeived by the config function)    
        // ...
    </pre>
        <pre>
// 'webpack.config.js' (file) ---------------------------------------------------------
    module.exports = function(env){
        env.myVal;                                                                     // -> 'dev'  
        return {}                                                                        // the config object to return   
    }    
    </pre>
        <p> <mark>build --node-env</mark> </p>
        <pre class="cmd">
    pall@Ryzen:~/myProject$ npx webpack build --node-env 21                            // value is received in 'process.env.NODE_ENV' but only in the config file   
        // ...
    </pre>
        <pre>
// 'webpack.config.js' (file) ---------------------------------------------------------
    process.env.NODE_ENV                                                               // -> 21
    
    module.exports = { }    
    </pre>
        <hr>
        <!--------------------------------------------------------------------------------------------------------------->
        <p><u> <mark>configtest</mark> </u></p>
        <pre class="cmd">
    pall@Ryzen:~/myProject$ npx webpack configtest myconfig.js                         // test the 'myconfig.js' file if it's a valid webpack configuration file   
        // ...
    </pre>
      </details>
      <details class="example">
        <summary> Example : </summary>
        <h4 style="color:darkblue;"><u> <mark>build</mark> CLI TEST </u></h4>
        <pre class="cmd">
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack                 // build is the default command so omitting it would run webpack   
        asset main.js 4.55 KiB [emitted] (name: main)
        runtime modules 670 bytes 3 modules
        cacheable modules 224 bytes
        ./src/index.js 164 bytes [built] [code generated]
        ./src/module1.js 32 bytes [built] [code generated]
        ./src/module2.js 28 bytes [built] [code generated]
        webpack 5.23.0 compiled successfully in 82 ms
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack build --entry ./src/myIndex.js --output-path ./dist/myBundle.js
        asset main.js 4.45 KiB [emitted] (name: main)                                  // entry and output set
        runtime modules 670 bytes 3 modules
        cacheable modules 188 bytes
        ./src/myIndex.js 128 bytes [built] [code generated]
        ./src/module1.js 32 bytes [built] [code generated]
        ./src/module2.js 28 bytes [built] [code generated]
        webpack 5.23.0 compiled successfully in 79 ms
        
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack build --config ./custom.config.js
        asset main.js 26 bytes [emitted] [minimized] (name: main)                      // sets the configuration file to use 
        ./src/index.js 37 bytes [built] [code generated]
        webpack 5.23.0 compiled successfully in 169 ms
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack --mode=production    // runs the bundler in production mode 
        // ...
    </pre>
        <hr>
        <pre class="cmd">
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack build --env myVal=dev
        developement
        asset main.js 4.44 KiB [emitted] (name: main)
        runtime modules 670 bytes 3 modules
        cacheable modules 188 bytes
        ./src/index.js 128 bytes [built] [code generated]
        ./src/module1.js 32 bytes [built] [code generated]
        ./src/module2.js 28 bytes [built] [code generated]
        webpack 5.23.0 compiled successfully in 80 ms
        pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$    
    </pre>
        <p> <mark>webpack.config.js</mark> file </p>
        <pre>
    module.exports = function(env){
        console.log( env.myVal );                                                      // -> 'dev'  
        return {}
    }    
    </pre>
        <hr>
        <pre class="cmd">
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack build --node-env 21
        21
        asset main.js 1.21 KiB [emitted] (name: main)
        ./src/index.js 37 bytes [built] [code generated]
        webpack 5.23.0 compiled successfully in 66 ms
    </pre>
        <p> <mark>webpack.config.js</mark> file </p>
        <pre>
    console.log( process.env.NODE_ENV )                                                // -> 21
    module.exports = { }    
    </pre>
        <hr>
        <!--------------------------------------------------------------------------------------------------------------->
        <h4 style="color:darkblue;"><u> <mark>configtest</mark> CLI TEST </u></h4>
        <pre class="cmd">
    pall@Ryzen:~/Documents/CodePlus/My Site/Webpack/_TEST$ npx webpack configtest myconfig.js   // test the 'myconfig.js' file if it's a valid webpack configuration file   
        // ...
    </pre>
      </details>
      <hr>
      <!--------------------------------------------------------------------------------------------------------------->
      <h2 style="color:darkblue;"><u> Running preset commands through npm package.json </u></h2>
      <p> - the prefered way to run webpack CLI commands is setting them up in the <mark>package.json</mark> file's <mark>script</mark> field then run the preset command through <mark>npm run &lt;cmd&gt;</mark> </p>
      <details class="example">
        <summary> DEMO </summary>
        <p> the local <mark>package.json</mark> file </p>
        <pre>
    {
    "name": "_TEST",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts": {
        "test": "echo \"Error: no test specified\" && exit 1",
        "start": "webpack build"                                                       // runs this commnad when calling '$ npm start' 
        "dev": "webpack --mode=development",                                           // runs this commnad when calling '$ npm run dev' 
        "prod": "webpack --mode=production"                                            // runs this commnad when calling '$ npm run prod' 
    },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "devDependencies": {
        "clean-webpack-plugin": "^3.0.0",
        "css-loader": "^5.0.2",
        "html-webpack-plugin": "^5.2.0",
        "mini-css-extract-plugin": "^1.3.8",
        "style-loader": "^2.0.0",
        "webpack": "^5.23.0",
        "webpack-cli": "^4.5.0",
        "webpack-dev-server": "^3.11.2"
    }
    }
    </pre>
        <pre class="cmd">
    pall@Ryzen:~/myProject$ npm start                                                  // runs the preset 'webpack build' command 
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/myProject$ npm run dev                                                // runs the preset 'webpack build --mode=development' command  
    
// ------------------------------------------------------------------------------------
    pall@Ryzen:~/myProject$ npm run prod                                               // runs the preset 'webpack build --mode=production' command  
    </pre>
      </details>
      <hr>
      <!--------------------------------------------------------------------------------------------------------------->
      <h2 class="headerExtra"><u> Watch mode and Dev Server </u></h2>
      <h2 style="color:darkblue;"><u> Watch mode </u></h2>
      <p> - running Webpack in Watch mode watches for changes in files in the current and all nested directores, once a change is detected Webpack automatically recompiles the bundle </p>
      <p> - we can start Watch mode directly from the command line <mark>$ npx webpack watch</mark> or set <mark>watch:true</mark> in config object in the webpack config file so Webpack will start in watch mode</p>
      <p> - we can set all sorts of watch mode options through the <mark>watchOptions</mark> object in the config file (see Webpack config file) </p>
      <details class="example">
        <summary> DEMO </summary>
        <p> - from command line </p>
        <pre class="cmd">
    pall@Ryzen:~/myProject $ npx webpack watch                                         // Webpack start in watch mode (stays open and actively keep wathing files) 
        // ...
    </pre>
        <p> - set watch mode and watch configurations in config file </p>
        <pre>
// webpack.config.js (file) -----------------------------------------------------------
    module.exports = {  
        mode: 'development',
        entry: './src/index.js', 
        watch: true,                                                                   // Webpack will start in Watch mode every time 
        watchOptions: {                                                                // watch options
            ignored: './node_modules'                                                    // does not watch the 'node_modules' directory
        }
    }
    </pre>
      </details>
      <hr>
      <!--------------------------------------------------------------------------------------------------------------->
      <h2 style="color:darkblue;"><u> Dev Server </u></h2>
      <p> - Webpack Dev Server is not available out of the box we must install it first <mark>$ npm install webpack-dev-server</mark> we can start the server from the command line <mark>$ npx webpack serve</mark> </p>
      <p> - the Dev Server serves the ready bundle (by default) in <mark>localhost:8080</mark> and internally uses watch mode, so changing files in the project will recompile the bundle and serve it </p>
      <p> - we can set all sorts of dev server options through the <mark>devServer</mark> object in the config file (see Webpack config file) </p>
      <details class="example">
        <summary> DEMO </summary>
        <pre>
// webpack.config.js (file) -----------------------------------------------------------
    module.exports = {  
        devServer: {
            port: 1000                                                                 // dev server will server content over 'localhost:1000'
        }
    </pre>
        <pre class="cmd">
    pall@Ryzen:~/myProject $ npx webpack serve                                         // starts the webpack development server 
        // ...
    </pre>
      </details>

      <br><br>
    </body>
  </html>
