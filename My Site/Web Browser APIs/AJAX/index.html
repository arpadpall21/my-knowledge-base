<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title> AJAX </title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../../Assets/stylesPages.css">
    <script src="../../Assets/scriptPages.js"></script>
  </head>
  <body>
    <h1> AJAX </h1>
    <p> Updated: ( 2020-07-21 / 2022-01-30 / 2025-03-12 )</p>
    <nav class="sitenav"> <a href="../index.html">MySite > </a>
      <a href="../index.html"> Web Browser APIs > </a> AJAX
    </nav>
    <table class="table">
      <tr>
        <th style="width:30%;"> Method / Property </th>
        <th style="width:70%;"> Description </th>
      </tr>
      <tr>
        <td> new XMLHttpRequest() </td>
        <td> - creates and returns an <strong>xhr</strong> (ajax) object, which is used to to make asynchronous (or synchronous) requests
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td>
          <strong>xhr</strong>.open(<strong>reqMethod:str, url:str</strong>, <i class="openable">async:bol,<div>
              <p> <mark>true</mark> = asynchronous request (Default) </p>
              <p> <mark>false</mark> = synchronous request </p>
            </div></i> <i class="openable">user:str, passwd<div>
              <p> - user name and password for authentication purposes </p>
            </div></i>)
        </td>
        <td>
          - initializes a new request (does not send it) (calling on an already open request is same as calling <mark>abort()</mark>)
        </td>
      </tr>
      <tr>
        <td>
          <strong>xhr</strong>.send(<i class="openable">msgBody:str|+<div>
              <p><b><u> Possible values are : </u></b></p>
              <p> <mark>USVString</mark> - string in JavaScript basically </p>
              <p> <mark>Document</mark> - which is serialized before sending </p>
              <p> <mark>Blob</mark> - file representation in front end JavaScript </p>
              <p> <mark>ArrayBuffer</mark> or any <mark>TypedArray</mark> </p>
              <p> <mark>FormData</mark> - form representation in front end JavaScript </p>
              <p> <mark>URLSearchParams</mark> - query stirng front end API </p>
            </div></i>)
        </td>
        <td> - sends the (initiated) request (automatically sends the <mark>Accept: */*</mark> header if it isn't specified otherwise)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.abort() </td>
        <td>
          - aborts an already sent request and sets <mark>readyState = 0</mark> and <mark>status = 0</mark> properties
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.readyState </td>
        <td>
          - returns a number indicating the sate of the <strong>xhr</strong> object <br>
          - (<u class="openable"><mark>0</mark> = UNSET<div>
              <p> - client created but the <mark>open()</mark> method not yet called </p>
            </div></u>) (<u class="openable"><mark>1</mark> = OPENED<div>
              <p> - <mark>open()</mark> method called </p>
            </div></u>) (<u class="openable"><mark>2</mark> = HEADERS_RECEIVED<div>
              <p> - <mark>send()</mark> has been called and the headers and status are available </p>
            </div></u>) (<u class="openable"><mark>3</mark> = LOADING<div>
              <p> - request loading, the <mark>responseText</mark> holds partial data </p>
            </div></u>) (<u class="openable"><mark>4</mark> = DONE<div>
              <p> - operation completed </p>
            </div></u>)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.responseURL </td>
        <td>
          - returns the URL (serialized in a string) from which the response is received
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.overrideMimeType(<strong>mimeType:str</strong>) </td>
        <td>
          - specifies the receiving data MIME type (overrides the MIME type sent by the server)
        </td>
      </tr>
      <tr>
        <td>
          <strong>xhr</strong>.responseType <small>[= <span class="openable">''|'text'|'arraybuffer'|'blob'|'document'|'json'<div>
                <p> <mark>''</mark> or <mark>'text'</mark> - <mark>DOMString</mark> (JavaScript string) </p>
                <p> <mark>'arrayBuffer'</mark> - <mark>ArrayBuffer</mark> </p>
                <p> <mark>'blob'</mark> - <mark>Blob</mark> object (represents a file in front end JavaScript) </p>
                <p> <mark>'document'</mark> - HTML or XML document </p>
                <p> <mark>'json'</mark> - JSON data </p>
              </div></span>]</small>
        </td>
        <td>
          - explicitly sets (and gets) the response data type, so the received data will be parsed according to this value <br>
          - the <mark>response</mark> property will contain the parsed data set by this property <br>
          - if wrong data type is specified <mark>null</mark> returned by the <mark>response</mark> property
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.response </td>
        <td> - returns the received response (data type is according to the <mark>responseType</mark> property)
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.responseText </td>
        <td> - returns the received response as text
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.responseXML </td>
        <td> - returns the received XML or HTML document (returns <mark>null</mark> if the received message is not a document type)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.status </td>
        <td> - returns the response status code (as number) (<mark>0</mark> before request or error)
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.statusText </td>
        <td> - returns the response status message (as string)
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.getAllResponseHeaders() </td>
        <td> - returns all received http headers in a string
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.getResponseHeader(<strong>headerName:str</strong>) </td>
        <td> - returns the (received) specified http header value in a string
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.setRequestHeader(<strong>headerName:str</strong>, <strong>headerVal:any</strong>) </td>
        <td>
          - <span class="openable">sets a request header<div>
              <p> - the <mark>Accept: */*</mark> header is automatically set if not specfied otherwise here </p>
              <p> - if this method is called multiple times on the same header name the passed value is added to the previously set header values </p>
            </div></span> (must be called after <mark>open()</mark> but before <mark>send()</mark> methods) <br>
          - for security reasons <span class="openable">forbidden headers<div>
              <p> - <mark>Accept-Charset</mark> </p>
              <p> - <mark>Accept-Encoding</mark> </p>
              <p> - <mark>Access-Control-Request-Headers</mark> </p>
              <p> - <mark>Access-Control-Request-Method</mark> </p>
              <p> - <mark>Connection</mark> </p>
              <p> - <mark>Content-Length</mark> </p>
              <p> - <mark>Cookie</mark> </p>
              <p> - <mark>Cookie2</mark> </p>
              <p> - <mark>Date</mark> </p>
              <p> - <mark>DNT</mark> </p>
              <p> - <mark>Expect</mark> </p>
              <p> - <mark>Feature-Policy</mark> </p>
              <p> - <mark>Host</mark> </p>
              <p> - <mark>Keep-Alive</mark> </p>
              <p> - <mark>Origin</mark> </p>
              <p> - <mark>Proxy-</mark> </p>
              <p> - <mark>Sec-</mark> </p>
              <p> - <mark>Referer</mark> </p>
              <p> - <mark>TE</mark> </p>
              <p> - <mark>Trailer</mark> </p>
              <p> - <mark>Transfer-Encoding</mark> </p>
              <p> - <mark>Upgrade</mark> </p>
              <p> - <mark>Via</mark> </p>
            </div></span> cannot be set
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.upload </td>
        <td>
          - returns an <mark>XMLHttpRequestUpload</mark> object which can be used to monitor the upload progress <u class="openable">through its event handler properties<div>
              <p> <mark>onloadstart</mark> - upload begun </p>
              <p> <mark>onloadend</mark> - upload finished, <u>does not differentiate success or failure upload</u> </p>
              <p> <mark>onprogress</mark> - periodically called to indicate the amount of progress made so far </p>
              <p> <mark>onabort</mark> - upload aborted </p>
              <p> <mark>onerror</mark> - upload errror </p>
              <p> <mark>onload</mark> - upload completed successfully </p>
              <p> <mark>ontimeout</mark> - upload timed out (reply did not arrive before the timeout set by the <mark><strong>xhr</strong>.timeout property</mark>) </p>
            </div></u>
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.timeout <small>[= <i>nr:sec</i>]</small> </td>
        <td> - gets or sets a timeout (seconds) after which the request automatically terminates
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.withCredentials <small>[= <i>bol</i>]</small> </td>
        <td>
          - gets or sets if credentials (cookies, authorization headers, TLS certificates,) will be sent with <u>corss-origin requests</u> (Default: <mark>false</mark>) <br>
          - also indicates that cookies are ignored in the response (when <mark>false</mark>)
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2"> Event Handler Properties </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onreadystatechange <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">readystatechange<div>
              <p> - Event Type = <mark>Event</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it each time when the <mark>readyState</mark> property value changes
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onprogress <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">progress<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it periodically when the request receives more data
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onabort <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">abort<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when the request is aborted
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onerror <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">error<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when an error is encountered
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onloadend <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">loadend<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when the download is ended <u>(regardless of success or failure)</u>
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onloadstart <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">loadstart<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when the download is started
        </td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.onload <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">load<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when the download is <u>successfully completed</u>
        </td>
      </tr>
      <tr>
        <td>|</td>
        <td></td>
      </tr>
      <tr>
        <td> <strong>xhr</strong>.ontimeout <strong>= fn(ev)</strong> </td>
        <td>
          - <mark class="openable">timeout<div>
              <p> - Event Type = <mark>ProgressEvent</mark> </p>
              <p> - Cancelable = NO </p>
              <p> - Bubbles = NO </p>
            </div></mark> event calls it when the <mark>timeout</mark> property value expires
        </td>
      </tr>
    </table>
    <h2 class="headerSection"> Notes : </h2>
    
    <h2 class="headerSection"> Useful Links : </h2>
    <p><a href="https://www.w3schools.com/js/js_ajax_intro.asp" target="_blank">AJAX (w3schools.com)</a></p>
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest" target="_blank">XMLHttpRequest (developer.mozilla.org)</a></p>
    <h2 class="headerSection"> Remember This : </h2>

    <h2 class="headerSection"> Description and Demonstration : </h2>
    <p> - AJAX (<b>A</b>synchronous <b>J</b>avaScript <b>A</b>nd <b>X</b>ML) is an API what can asynchronously (or synchronously) make requests to the server (communicates with the server regardless of the main page 'behind the scenes') </p>
    <p> - for security reasons by Default AJAX can only make <u>same-origin requests</u> (the CORS protocol controls cross-origin requests) </p>
    <pre>
    var xhr = new XMLHttpRequest();                                                    // xhr object created 
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                                              // -> "test file's content"      // content of the requested file 
        }
    }
    xhr.open("GET", "http://localhost:1000/TEST/testFile.txt");                        // testing this on 'localhost:1000'
    xhr.send();
    </pre>
    <hr>
    <!--------------------------------------------------------------------------------------->
    <h2 style="color:darkblue;"><u> The <mark>open()</mark> / <mark>send()</mark> / <mark>abort()</mark> / <mark>readyState</mark> / <mark>responseURL</mark> / <mark>overrideMimeType()</mark> / <mark>responseType</mark> / <mark>response</mark> / <mark>responseText</mark> / <mark>responseXML</mark> / <mark>status</mark> / <mark>statusText</mark> / <mark>getAllResponseHeaders()</mark> / <mark>getResponseHeader()</mark> / <mark>setRequestHeader()</mark> / <mark>upload</mark> / <mark>timeout</mark> / <mark>withCredentials</mark> methods and properties </u></h2>
    <h3 style="color:darkblue;"><u> Events Handler Properites: <mark>onreadystatechange</mark> / <mark>onprogress</mark> / <mark>onabort</mark> / <mark>onerror</mark> / <mark>onloadstart</mark> / <mark>onloadend</mark> / <mark>onload</mark> / <mark>ontimeout</mark> </u></h3>
    <details class="example">
      <summary> DEMO </summary>
      <pre>
    var xhr = new XMLHttpRequest();                                                    // a new 'xhr' object created 
    
// responseType / overrideMimeType() --------------------------------------------------
    xhr.responseType = 'text'                                                          // the response is explicitly parsed to text 
    xhr.overrideMimeType('text/plain');                                                // overrides the received MIME type sent by the server (the received data MIME type is treated according to this setting)    
    
// setRequestHeader()  / withCredentials ----------------------------------------------
    xhr.setRequestHeader('Content-Disposition', 'attachement');                        // sets a request header  
    xhr.withCredentials = false;                                                       // no credentials are sent with the request (Default settings)
                                                                                         // received credentials are ignored by the browser 
// readyState / status / onreadystatechange -------------------------------------------
    xhr.onreadystatechange = function(ev){                                             // tirggered each time the 'readyState' property value changes 
        if (this.readyState == 4 && this.status == 200) {                              // 'readyState' value changes according to the state of the XHR object (4 = DONE)    // 'status' response status (200 = OK)    
        
  // responseURL / response / responseText / responseXML ------------------------------
            this.responsURL;                                                           // -> "http://localhost:1000/testFile.txt"   // the url where the response is received from  
            
            this.response;                                                             // -> 'server response'             // contains the server response // -! the received data type is parsed according to the 'responseType' property    
            this.responseText;                                                         // -> 'server response'             // the received message as text 
            this.responseXML;                                                          // -> null                          // the received message as XML or HTML document (null because in this case the received data is a string)
            
  // status / statusText / getAllResponseHeaders() / getResponseHeader() --------------
            this.status;                                                               // -> 200                           // response status 
            this.statusText;                                                           // -> 'OK'                          // response status text   
            
            this.getAllResponseHeaders();                                              // -> 'connection: keep-alive ...'  // returns all received response headers    
            this.getResponseHeader('connection');                                      // -> 'keep-alive'                  // returns the specified received response header value   
        }
    }
    
// open() / send() --------------------------------------------------------------------
    xhr.open("GET", "http://localhost:1000/testFile.txt");                             // initiating a GET request to the specified url 
    xhr.send();                                                                        // sends the initiated request   
    
// abort() / onabort / onerror --------------------------------------------------------
    xhr.abort();                                                                       // aborts the issued request 
    
    xhr.onabort = function(e){ }                                                       // triggered when the request is aborted 
    xhr.onerror = function(e){ }                                                       // triggered when an error is occured 
    
// onloadstart / onloadend / onload ---------------------------------------------------
    xhr.onloadstart = function(e){ }                                                   // triggered when the download starts  
    xhr.onloadend = function(e){ }                                                     // triggered when the load ends  // -! this only monitors the load end (regardelss of successful or failed load)  
    xhr.onload = function(e){ }                                                        // triggered when the load is successfully completed  
    
// timeout / ontimeout ----------------------------------------------------------------
    xhr.timeout = 2000;                                                                // if the server does not respond within 2 second the request ends 
    
    xhr.ontimeout = = function(e){ }                                                   // triggered when the 'timeout' property value expires   
    
// onprogress -------------------------------------------------------------------------
    xhr.onprogress = = function(e){ }                                                  // triggered periodically when new data is received from the server    
    
// upload -----------------------------------------------------------------------------
    xhr.upload.onload = function(e){ };                                                // tiggered when uploading data to the server successfully completed (not triggered in this case because this is a GET request)    
    </pre>

    </details>
    <details class="example">
      <summary> Example : </summary>
      <h4 style="color:darkblue;"><u> <mark>open()</mark> / <mark>send()</mark> GET request TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                                              // -> "test file's content"   // the requested 'testFile.txt' content 
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile");                                 // initiates a GET request to the specified url 
    xhr.send();                                                                        // sending the request 
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>open()</mark> / <mark>send()</mark> POST request TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.open("POST", "http://localhost:1000");                                         // POST method to send data to the url 
    xhr.send('xhr sent data');                                                         // sending the actual data 
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>readyState</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){                                             // event handler triggers every time the 'readyState' value changes 
        console.log( this.readyState );                                                // -> 0  |  1  |  2  |  3  |  4   // all 5 stages are triggered 
        
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile");
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>abort()</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 3) this.abort();                                        // aborts the request when LOADING  
        
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                  
            console.log( this.getAllResponseHeaders() );
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile");
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>responseType</mark> / <mark>responseURL</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.responseType = 'blob';                                                         // the response will be parsed to a Blob object 
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.responseURL );                                           // -> 'http://localhost:1000/testFile.txt'  
            console.log( this.response );                                              // -> Blob{ ... }       // the received data is parsed into a Blob object 
            console.log( this.responseXML );                                           // -! throws an Error because the received data is parsed to a Blob and therefore cannot be parsed to an XML document    
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt");
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>response</mark> / <mark>responseText</mark> / <mark>responseXML</mark> text received TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                                              // -> 'test file content'
            console.log( this.responseText );                                          // -> 'test file content'
            console.log( this.responseXML );                                           // -> null                      // because the received data is not an XML document   
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt");
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>response</mark> / <mark>responseText</mark> / <mark>responseXML</mark> XML document received TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                                              // -> '&lt;CATALOG&gt; ...'           // XML document serialized 
            console.log( this.responseText );                                          // -> '&lt;CATALOG&gt; ...'
            console.log( this.responseXML );                                           // -> #documeng                 // returns the XML document    
        }
    }
    
    xhr.open("GET", "http://localhost:1000/cd.xml");                                   // XML document requested 
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>overrideMimeType()</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.overrideMimeType('text/plain');                                                // we explicitly set the received MIME type to text 
        
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response );                                              // -> '&lt;CATALOG&gt; ...'      
            console.log( this.responseText );                                          // -> '&lt;CATALOG&gt; ...'
            console.log( this.responseXML );                                           // -> null                 // null because the response is parsed according to the set MIME type     
        }
    }
    
    xhr.open("GET", "http://localhost:1000/cd.xml");                                   // XML document requested 
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>status</mark> / <mark>statusText</mark> / <mark>getAllResponseHeaders()</mark> / <mark>getResponseHeader()</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
            
            console.log( this.status );                                                // -> 200
            console.log( this.statusText );                                            // -> 'OK'
            
            console.log( this.getAllResponseHeaders() );                               // -> 'connection: keep-alive content-type: text/plain date: Wed, 22 Jul 2020 17:55:34 GMT transfer-encoding: chunked'  
            console.log( this.getResponseHeader('content-type') );                     // -> 'text/plain'
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt"); 
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>setRequestHeader()</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt"); 
    xhr.setRequestHeader('X-CustomHeader', 21);                                        // setting a request header 
    // xhr.setRequestHeader('Date', 21);                                               // -! this would throw an error because the 'Date' header is a forbidden header 
    
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>upload</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
    }
    
// upload -------------------------------------------------------------
    xhr.upload.onloadstart = function(ev){ console.log('upload started!'); };
    xhr.upload.onloadend = function(ev){ console.log('upload end!'); };
    xhr.upload.onprogress = function(ev){ console.count('progress'); };
    xhr.upload.onload = function(ev){ console.log('load complete!'); };
    
    xhr.open("POST", "http://localhost:1000/testFile.txt"); 
    xhr.send('some data');  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>timeout</mark> (also event handler property) TEST </u></h4>
      <p> - server configured not to respond to this AJAX request </p>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    xhr.timeout = 2000;                                                                // after 2 seconds the XHR request times out if the server does not respond   
    
    xhr.ontimeout = function(ev){ console.log('AJAX request timed out!') };            // triggered after 2 seconds 
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt"); 
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>withCredentials</mark> TEST </u></h4>
      <pre>
&lt;script&gt;
    document.cookie = 'docCookie=val1';                                                // setting a cookie to the document 
    
    var xhr = new XMLHttpRequest();
    xhr.withCredentials = true;                                                        // this allows the browser to send the above set cookie to the cross-origin server   
                                                                                       // -! if 'false' no cookies are sent with the request but also the browser ignores all recieved cookes from the server 
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
            
            console.log( this.getAllResponseHeaders() );
            
            console.log( document.cookie );                                            // -> 'docCookie=val1; srvCookie=1000'  // the received cookie is also present here    
        }
        
    }
    
    xhr.open("GET", "http://localhost:1001");                                          // cross-origin request (this site runs on 'http://localhost:1000')
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>onloadstart</mark> / <mark>onloadend</mark> / <mark>onload</mark> / <mark>progress</mark> event handlers TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onloadstart = function(e){ console.log('loading started!') }
    xhr.onloadend = function(e){ console.log('loading ended!') }
    xhr.onload = function(e){ console.log('loading successfully ended!') }
    xhr.onprogress = function(e){ console.count('loadprogress') }
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
        
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt");  
    xhr.send();  
&lt;/script&gt;
    </pre>
      <hr>
      <!--------------------------------------------------------------------------------------->
      <h4 style="color:darkblue;"><u> <mark>onabort</mark> event handler TEST </u></h4>
      <pre>
&lt;script&gt;
    var xhr = new XMLHttpRequest();
    
    xhr.onabort = function(e){ console.log('request aborted!') }                       // emitted 
    
    xhr.onreadystatechange = function(ev){
        if (this.readyState == 4 && this.status == 200) {
            console.log( this.response ); 
        }
    }
    
    xhr.open("GET", "http://localhost:1000/testFile.txt");  
    xhr.send();  
    
    xhr.abort();                                                                       // aborting request 
&lt;/script&gt;
    </pre>

    </details>

    <br><br>
  </body>
</html>